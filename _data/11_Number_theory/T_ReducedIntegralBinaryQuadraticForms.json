{
  "alternatePhrases": [],
  "definition": "A *positive* binary form is one where\n$F(x,y)\\geq 0\\  \\forall x,y\\in{\\mathbb{Z}}$.\n\nThis article deals only with positive integral binary quadratic forms\n(i.e. those with negative discriminant and with $a>0$). Some but not all\nof this theory applies to forms with positive discriminant.\n\nIf $F$ is positive, then $a>0$. If $\\Delta(F)<0$ and either $a>0$ or\n$c>0$, then $F$ is positive.\n\nIf $F$ is positive, then $F(1,0)=a$, so $a>0$. If $\\Delta(F)<0$, then\n$4aF(x,y) = (2ax+by)^2-\\Delta y^2 \\geq 0$. Thus if $a>0$, then\n$F(x,y)\\geq 0$. The proof for the case $c>0$ is identical.\n\nA primitive positive form $ax^2+bxy+cy^2$ is *reduced* if\n$$|b|\\leq a\\leq c\\text{, and }b\\geq 0\\text{ if either }|b|=a\\text{ or }a=c$$\nThis is equivalent to saying that $-a\\leq b\\leq a\\leq c$ and that $b$\ncan be negative only if $a<c$ or $-a<b$. Thus $(3,-2,4)$ is reduced, but\n$(3,-2,3)$ is not.\n\nIt turns out that each proper equivalence class of primitive positive\nforms contains a single reduced form, and thus we can understand how\nmany classes there are of a given discriminant by studying only the\nreduced forms.\n\nIf $F$ is a primitive positive reduced form with discriminant\n$\\Delta\\neq -3$, $F(x,y)=ax^2+bxy+cy^2$, then the minimum value assumed\nby $F$ if $x,y$ are not both zero is $a$. If $a<c$, then this value is\nassumed only for $(x,y)=(\\pm1,0)$; if $a=c$; it is assumed for\n$(x,y)=(\\pm 1,0)$ and $(x,y)=(0,\\pm 1)$.\n\nSince $|b|\\leq a\\leq c$, it follows that\n$$F(x,y)\\geq (a-|b|+c)\\min(x^2,y^2)$$ Thus, $F(x,y)\\geq a-|b|+c$\nwhenever $xy\\neq 0$, while if $x$ or $y$ is zero, then $F(x,y)\\geq a$.\nSo $a$ is clearly the smallest nonzero value of $F$.\n\nIf $a<c$, then $F(x,y)\\geq a+(c-|b|)>a$ if $xy\\neq 0$, and\n$F(0,y)\\geq c>a$ for $y\\neq 0$, so $F$ achieves its minimum only at\n$(x,y)=(\\pm 1,0)$.\n\nIf $a=c$, then $|b|\\neq a$ since otherwise $F$ is not reduced (we cannot\nhave $a=c=1, b=\\pm 1$ else we have a form of discriminant $-3$). Thus\nagain $c-|b|>0$ and thus $F(x,y)>a$ if $xy\\neq 0$, so in this case the\nresult follows as well.\n\nNote that the reduced form of discriminant $-3$, $x^2+xy+y^2$, also\nachieves its minimum value at $(1,-1),(-1,1)$.\n\nIf $F,G$ are primitive positive reduced forms with $F\\sim G$, then\n$F=G$.\n\nWe take the cases $\\Delta\\neq -3$ and $\\Delta=-3$ separately.\n\nFirst assume $\\Delta\\neq -3$ so we can apply the above theorem.\n\nSince $F\\sim G$, we can write\n$G(x,y)=F(\\alpha x+\\beta y,\\gamma x+\\delta y)$ with\n$\\alpha\\delta-\\beta\\gamma=1$. Suppose\n$F=ax^2+bxy+cy^2, G=a'x^2+b'xy+c'y^2$. Now, $F$ and $G$ have the same\nminimum value, so $a=a'$.\n\nIf $a<c$, then $F$ achieves its minimum only at $(pm 1,0)$, so\n$a=a'=G(1,0)=F(\\alpha,\\gamma)$ and thus $\\alpha=\\pm 1, \\gamma=0$. So\n$G(x,y)=F(\\pm x+ry,\\pm y)$ and thus $b'=b+2ra$. Since $G$ is also\nreduced, $b=b'$ and thus $c=c'$ and $F=G$.\n\nIf instead $a=c$, then instead of concluding that $\\alpha=\\pm 1$ we can\nonly conclude that $\\alpha=\\pm 1$ or $\\gamma=\\pm 1$. If $\\alpha=\\pm 1$,\nthe argument carries through as above. If $\\gamma=\\pm 1$, then\n$\\alpha=0, \\beta=\\mp 1$, so $G(x,y)=F(\\mp y,\\pm x+ry)$ and thus\n$b'=\\pm 2cr-b$. Thus $b'=-b$. But then $c=c'$ since the discriminants\nare equal, and thus both $b,b'\\geq 0$. So $b=b'=0$ and we are done.\n\nFinally, in the case $\\Delta=-3$, we see that for any such reduced form,\n$3=4ac-b^2\\geq 4a^2-a^2=3a^2$, so $a=1, b=\\pm 1, c=1$. Thus $b=1$ since\notherwise the form is not reduced. So the only reduced form of\ndiscriminant $-3$ is in fact $x^2+xy+y^2$.\n\n\\[thm:unique\\] Every primitive positive form is properly equivalent to a\nunique reduced form.\n\nWe just proved uniqueness, so we must show existence. Note that I used a\ndifferent method of proof in class that relied on \u201cinfinite descent\u201d to\nget the result in the first paragraph below; the method here is just as\ngood but provides less insight into how to actually reduce a form.\n\nWe first show that any such form is properly equivalent to some form\nsatisfying $|b|\\leq a\\leq c$. Among all forms properly equivalent to the\ngiven one, choose $F(x,y)=ax^2+bxy+cy^2$ such that $|b|$ is as small as\npossible (there may be multiple such forms; choose one of them). If\n$|b|>a$, then $$G(x,y)=F(x+my,y)=ax^2+(2am+b)xy+c' y^2$$ is properly\nequivalent to $F$, and we can choose $m$ so that $|2am+b|<|b|$,\ncontradicting our choice of minimal $|b|$. So $|b|\\leq a$; similarly,\n$|b|\\leq c$. Finally, if $a>c$, simply interchange $a$ and $c$ (by\napplying the proper equivalence $(x,y)\\mapsto(-y,x)$) to get the\nrequired form.\n\nTo finish the proof, we show that if $F(x,y)=ax^2+bxy+cy^2$, where\n$|b|\\leq a\\leq c$, then $F$ is properly equivalent to a reduced form.\nThe form is already reduced unless $b<0$ and either $a=-b$ or $a=c$. But\nin these cases, the form $G(x,y)=ax^2-bxy+cy^2$ is reduced, so it\nsuffices to show that $F$ and $G$ are properly equivalent. If $a=-b$,\nthen $(x,y)\\mapsto(x+y,y)$ takes $ax^2-axy+cy^2$ to $ax^2+axy+cy^2$,\nwhile if $a=c$, then $(x,y)\\mapsto(-y,x)$ takes $ax^2+bxy+ay^2$ to\n$ax^2-bxy+ay^2$.\n\nLet\u2019s see how to reduce $82x^2+51xy+8y^2$ to $x^2+xy+6y^2$:\n\n  Form                        Transformation           Result\n  --------------------------- ------------------------ --------------------------------------\n  $82x^2+51xy+8y^2$           $(x,y)\\mapsto(-y,x)$     $8x^2-51xy+82y^2$\n  \\[3pt\\] $8x^2-51xy+82y^2$   $(x,y)\\mapsto(x+3y,y)$   $8(x+3y)^2-51(x+3y)y+82y^2=$\n                                                       $8x^2+48xy+72y^2-51xy-153y^2+82y^2=$\n                                                       $8x^2-3xy+y^2$\n  \\[3pt\\] $8x^2-3xy+y^2$      $(x,y)\\mapsto(-y,x)$     $x^2+3xy+8y^2$\n  \\[3pt\\] $x^2+3xy+8y^2$      $(x,y)\\mapsto(x-y,y)$    $(x-y)^2+3(x-y)y+8y^2=x^2+xy+6y^2$\n  \\[3pt\\] $x^2+xy+6y^2$                                \n\nIf $F(x,y)=ax^2+bxy+cy^2$ is a positive reduced form with $\\Delta<0$,\nthen $a\\leq \\sqrt{\\frac{|\\Delta|}{3}}$.\n\n$-\\Delta = 4ac - b^2 \\geq 4a^2-a^2$ since the form is reduced. So\n$-\\Delta \\geq 3a^2$, and the result follows.\n\nIf $\\Delta<0$, then *$h(\\Delta)$* is the number of classes of primitive\npositive forms of discriminant $\\Delta$.\n\nIf $\\Delta<0$, then $h(\\Delta)$ is finite, and $h(\\Delta)$ is equal to\nthe number of primitive positive reduced forms of discriminant\n$\\Delta$.\\[cor:finite\\]\n\nEssentially obvious. Since every positive form is properly equivalent to\na (unique) reduced form, $h(\\Delta)$ is clearly equal to the number of\npositive reduced forms of discriminant $\\Delta$. But given a reduced\nform of discriminant $\\Delta$, there are only finitely many choices for\n$a>0$, by the proposition. This constrains us to finitely many choices\nfor $b$, since $-a<b\\leq a$. $a$ and $b$ determine $c$ since $\\Delta$ is\nfixed.\n\n**Examples**: $\\Delta=-4$: $b^2-4ac=-4 \\Rightarrow b$ even,\n$|b|\\leq |a|\\leq \\sqrt{\\frac{4}{3}} \\Rightarrow b=0$. So $(1,0,1)$,\ncorresponding to $x^2+y^2$, is the only reduced form of discriminant\n$-4$. Note that this provides another proof that primes $\\equiv 1\\pod 4$\nare representable as the sum of two squares, since all such primes have\n${\\left(\\frac{-4}{p}\\right)}={\\left(\\frac{-1}{p}\\right)}=1$ and thus are\nrepresentable by this quadratic form.\n\n$\\Delta=-23$: $b^2-4ac=-23 \\Rightarrow b$ odd,\n$|b|\\leq a \\leq \\sqrt{\\frac{23}{3}} \\Rightarrow b=\\pm 1$. So\n$ac=6, a<c$. This gives us\n\n  ---------------------- --\n   $(1,\\phantom{-}1,6)$  \n        $(1,-1,6)$       \n   $(2,\\phantom{-}1,3)$  \n        $(2,-1,3)$       \n  ---------------------- --\n\nThere are three equivalence classes of positive reduced forms with\ndiscriminant $-23$.\n\n$\\Delta=-55$: $4ac-b^2=55$, so $b$ is odd,\n$|b|\\leq \\sqrt{\\frac{55}{3}} \\Rightarrow |b|=1,\\pm 3$. So\n$ac=14\\text{ or }16, a\\leq c$. So the forms are\n\n  --------------------------------- --\n        $(1,\\phantom{-}1,14)$       \n             $(1,-1,14)$            \n   $(2,\\phantom{-}1,\\phantom{1}7)$  \n        $(2,-1,\\phantom{1}7)$       \n   $(4,\\phantom{-}3,\\phantom{1}4)$  \n        $(4,-3,\\phantom{1}4)$       \n  --------------------------------- --\n\nThere are four classes of forms of discriminant $-55$.\n\n$\\Delta=-163$: $b^2-4ac=-163 \\Rightarrow b$ odd,\n$|b|\\leq |a|\\leq \\sqrt{\\frac{163}{3}} \\cong \\sqrt{55}$. So\n$b=\\pm 1, \\pm 3,\\pm 5,\\pm 7$, and $ac=\\frac{b^2+163}{4}$, so\n$ac=41,43,45,47$. Since $a<c$, we must have $a=1$; thus $b=\\pm 1$ and\nthus we get only $(1,\\pm 1,41)$. But $(1,-1,41)$ is properly equivalent\nto $(1,1,41)$ via $(x,y)\\mapsto(x+y,y)$, so there is only one\nequivalence class of positive reduced forms with discriminant $-163$.",
  "language": "INFORMAL",
  "phrase": "Reduced Integral Binary Quadratic Forms",
  "remarks": "",
  "citations": [
    {
      "textCitation": "https://planetmath.org/ReducedIntegralBinaryQuadraticForms"
    }
  ],
  "indexable": true
}