{
  "argumentText": "First, we prove the following lemma:\\\n[**Lemma:**]{}\\\nA convex combination of doubly stochastic matrices is doubly stochastic.\n[**Proof:**]{}\\\nLet $\\{A_i\\}_{i=1}^m$ be a collection of $n \\times n$ doubly-stochastic\nmatrices, and suppose $\\{\\lambda_i\\}_{i=1}^m$ is a collection of scalars\nsatisfying $\\sum_{i=1}^m \\lambda_i=1$ and $\\lambda_i \\geq 0$ for each\n$i=1,\\ldots,m$. We claim that $A=\\sum_{i=1}^m \\lambda_iA_i$ is doubly\nstochastic.\\\nTake any $i \\in \\{1,\\ldots,m\\}$. Since $A_i$ is doubly stochastic, each\nof its rows and columns sum to 1. Thus each of the rows and columns of\n$\\lambda_iA_i$ sum to $\\lambda_i$.\\\nBy the definition of elementwise summation, given matrices $N=M_1+M_2$,\nthe sum of the entries in the $i$th column of $N$ is clearly the sum of\nthe sums of entries of the $i$th columns of $M_1$ and $M_2$\nrespectively. A similar result holds for the $j$th row.\\\nHence the sum of the entries in the $i$th column of $A$ is the sum of\nthe sums of entries of the $i$th columns of $\\lambda_kA_k$ for each $i$,\nthat is, $\\sum_{k=1}^m \\lambda_k=1$. The sum of entries of the $j$th row\nof $A$ is the same. Hence $A$ is doubly stochastic.\\\nObserve that since a permutation matrix has a single nonzero entry,\nequal to 1, in each row and column, so the sum of entries in any row or\ncolumn must be 1. So a permutation matrix is doubly stochastic, and on\napplying the lemma, we see that a convex combination of permutation\nmatrices is doubly stochastic. This provides one direction of our proof;\nwe now prove the more difficult direction: suppose $B$ is\ndoubly-stochastic. Define a weighted graph $G=(V,E)$ with vertex set\n$V=\\{r_1,\\ldots,r_n,c_1,\\ldots,c_n\\}$, edge set $E$, where\n$e_{ij}=(r_i,c_i) \\in E$ if $B_{ij} \\neq 0$, and edge weight $\\omega$,\nwhere $\\omega(e_{ij})=B_{ij}$. Clearly $G$ is a bipartite graph, with\npartitions $R=\\{r_1,\\ldots,r_n\\}$ and $C=\\{c_1,\\ldots,c_n\\}$, since the\nonly edges in $E$ are between $r_i$ and $c_j$ for some\n$i,j \\in \\{1,\\ldots,n\\}$. Furthermore, since $B_{ij} \\geq 0$, then\n$\\omega(e)>0$ for every $e \\in E$. For any $A \\subset V$ define $N(A)$,\nthe neighbourhood of $A$, to be the set of vertices $u \\in V$ such that\nthere is some $v \\in A$ such that $(u,v) \\in E$. We claim that, for any\n$v \\in V$, $\\sum_{u \\in N(\\{v\\})} \\omega(u,v)=1$. Take any $v \\in V$;\neither $v \\in R$ or $v \\in C$. Since $G$ is bipartite, $v \\in R$ implies\n$N(\\{v\\}) \\subset C$, and $v \\in C$ implies $N(\\{v\\}) \\subset R$. Now,\n$$\\begin{array}{c} {\\displaystyle\nv=r_i \\implies \\sum_{u \\in N(r_i)} \\omega(r_i,u)=\\sum_{\\stackrel{j=1,}{e_{ij} \\in E}}^n \\omega(r_i,c_j) = \\sum_{\\stackrel{j=1,}{B_{ij} \\neq 0}}^n B_{ij}=\n\\sum_{j=1}^n B_{ij}=1 } \\\\\n{\\displaystyle v=c_j \\implies \\sum_{u \\in N(c_j)} \\omega(u,c_j)=\\sum_{\\stackrel{i=1,}{e_{ij} \\in E}}^n \\omega(r_i,c_j) = \\sum_{\\stackrel{i=1,}{B_{ij} \\neq 0}}^n B_{ij}=\n\\sum_{i=1}^n B_{ij}=1 }\n\\end{array}$$ since $B$ is doubly stochastic. Now, take any\n$A \\subset R$. We have\n$$\\sum_{\\stackrel{v \\in A}{w \\in N(A)}} \\omega(v,w)\n   = \\sum_{v \\in A} \\sum_{w \\in N(\\{v\\})} \\omega(v,w)\n   = \\sum_{v \\in A} 1 = |A|$$ Let $B=N(A)$. But then clearly\n$A \\subset N(B)$, by definition of neighbourhood. So\n$$|N(A)|=|B| = \\sum_{\\stackrel{v \\in B}{w \\in N(B)}} \\omega(v,w)\n      \\geq \\sum_{\\stackrel{v \\in B}{w \\in A}}  \\omega(v,w)\n       = \\sum_{\\stackrel{w \\in A}{v \\in N(A)}} \\omega(v,w) = |A|$$ So\n$|N(A)| \\geq |A|$. We may therefore apply the graph-theoretic version of\nHall\u2019s marriage theorem to $G$ to conclude that $G$ has a perfect\nmatching. So let $M \\subset E$ be a perfect matching for $G$. Define an\n$n \\times n$ matrix $P$ by\n$$P_{ij} = \\left\\{ \\begin{array}{ll} 1 & \\text{if } e_{ij} \\in M \\\\ 0 & \\text{otherwise} \\end{array} \\right.$$\nNote that $B_{ij}=0$ implies $P_{ij}=0$: if $B_{ij}=0$, then\n$(r_i,c_j) \\not \\in E$, so $(r_i,c_j) \\not \\in M$, which implies\n$P_{ij}=0$. Further, we claim that $P$ is a permutation matrix:\\\nLet $i$ be any row of $P$. Since $M$ is a perfect matching of $G$, there\nexists $e_0 \\in M$ such that $r_i$ is an end of $e_0$. Let the other end\nbe $c_j$ for some $i$; then $P_{ij}=1$.\\\nSuppose $i_i,i_2 \\in \\{1,\\ldots,n\\}$ with $i_1 \\neq i_2$ and\n$P_{i_1,j}=P_{i_2,j}=1$ for some $j$. This implies\n$(r_{i_1},c_j),(r_{i_2},c_j) \\in M$, but this implies the vertex $i$ is\nthe end of two distinct edges, which contradicts the fact that $M$ is a\nmatching.\\\nHence, for each row and column of $P$, there is exactly one nonzero\nentry, whose value is 1. So $P$ is a permutation matrix. Define\n$\\displaystyle{\\lambda=\\min_{i,j \\in \\{1,\\ldots,n\\}} \\{ B_{ij} \\mid P_{ij} \\neq 0\\}}$.\nWe see that $\\lambda>0$ since $B_{ij} \\geq 0$, and\n$P_{ij} \\neq 0 \\implies B_{ij} \\neq 0$. Further, $\\lambda=B_{pq}$ for\nsome $p,q$. Let $D=B-\\lambda P$. If $D=0$, then $\\lambda=1$ and $B$ is a\npermutation matrix, so we are done. Otherwise, note that $D$ is\nnonnegative; this is clear since\n$\\lambda P_{ij} \\leq \\lambda \\leq B_{ij}$ for any $B_{ij} \\neq 0$.\nNotice that\n$D_{pq}=B_{pq}-\\lambda P_{pq} = \\lambda - \\lambda \\cdot 1 = 0$. Note\nthat since every row and column of $B$ and $P$ sums to 1, that every row\nand column of $D=B-\\lambda P$ sums to $1-\\lambda$. Define\n$B'=\\frac{1}{1-\\lambda}D$. Then every row and column of $B'$ sums to 1,\nso $B'$ is doubly stochastic. Rearranging, we have\n$B=\\lambda P + (1-\\lambda) B'$. Clearly $B_{ij}=0$ implies that\n$P_{ij}=0$ which implies that $B'_{ij}=0$, so the zero entries of $B'$\nare a superset of those of $B'$. But notice that\n$B'_{pq}=\\frac{1}{1-\\lambda} D_{pq}=0$, so the zero entries of $B'$ are\na strict superset of those of $B$. We have decomposed $B$ into a convex\ncombination of a permutation matrix and another doubly stochastic matrix\nwith strictly more zero entries than $B$. Thus we may apply this\nprocedure repeatedly on the doubly stochastic matrix obtained from the\nprevious step, and the number of zero entries will increase with each\nstep. Since $B$ has at most $n^2$ nonzero entries, we will obtain a\nconvex combination of permutation matrices in at most $n^2$ steps. Thus\n$B$ is indeed expressible as a convex combination of permutation\nmatrices.\n\n### References {#references .unnumbered}\n\nG. Birkhoff, \u201cTres observaciones sobre el algebra lineal,\u201d Univ. Nac.\nTucum[\u00e1]{}n Rev, Ser. A, no. 5, pp147\u2013151. (1946)",
  "conclusion": "#P_BirkhoffvonNeumannTheorem",
  "language": "INFORMAL",
  "premises": [
    "#P_planetmath_ZFC"
  ],
  "citations": [
    {
      "textCitation": "https://planetmath.org/ProofOfBirkhoffvonNeumannTheorem"
    }
  ],
  "indexable": false,
  "names": [
    "proof of Birkhoff-von Neumann theorem"
  ]
}