{
  "language": "INFORMAL",
  "remarks": "",
  "statement": "Let ${\\mathbf}{e}_i$ denote the (column) vector whose $i$th position is\n$1$ and where all other positions are $0$. Denote by $[n]$ the set\n$\\{1,\\dotsc,n\\}$. Denote by ${\\mathrm{M}}_n({\\mathcal}{K})$ the set of\nall $n \\times \nn$ matrices over ${\\mathcal}{K}$, and by\n${\\mathrm{GL}}_n({\\mathcal}{K})$ the set of all invertible elements of\n${\\mathrm{M}}_n({\\mathcal}{K})$. Let $d_i$ be the function which\nextracts the $i$th diagonal element of a matrix, i.e., $d_i(A) \n= {{\\mathbf}{e}_i^{\\mathrm{T}}\\!} A {\\mathbf}{e}_i$.\n\nLet ${\\mathcal}{K}$ be a field, let $n$ be a positive integer, and let\n$\\sim$ be an equivalence relation on $[n]$ such that if $i \\sim j$ and\n$i \\leqslant k \\leqslant j$ then $k \\sim i$. Let $A_1,\\dotsc,A_r \n  \\in {\\mathrm{M}}_n({\\mathcal}{K})$ be pairwise commuting upper\ntriangular matrices. If these matrices and $\\sim$ are related such that\n$$i \\sim j\n    \\quad\\text{if and only if}\\quad\n    d_i(A_k) = d_j(A_k)\n    \\text{ for all }k \\in [r]\\text{,}$$ then there exists a matrix\n$B \\in {\\mathrm{GL}}_n({\\mathcal}{K})$ such that:\n\n1.  \\[Cond:Block\\] If\n    ${{\\mathbf}{e}_i^{\\mathrm{T}}\\!} B^{-1} A_k B {\\mathbf}{e}_j \\neq 0$\n    then $i \\sim j$ and $i \\leqslant j$.\n\n2.  \\[Cond:Same\\] If $i \\sim j$ then\n    ${{\\mathbf}{e}_i^{\\mathrm{T}}\\!} B^{-1} A_k B \n          {\\mathbf}{e}_j = {\\mathbf}{e}_i^{\\mathrm{T}} A_k {\\mathbf}{e}_j$.\n\nCondition\u00a0\\[Cond:Block\\] says that if an element of $B^{-1}A_kB$ is\nnonzero then both its row and column indices must belong to the same\nequivalence class of $\\sim$, i.e., the nonzero elements of $B^{-1}A_kB$\nonly occur in particular along the diagonal, and these blocks correspond\nto equivalence classes of $\\sim$. Condition\u00a0\\[Cond:Same\\] says that\nwithin one of these blocks, $B^{-1}A_kB$ is equal to $A_k$.\n\nThe proof of the theorem requires the following lemma.\n\n\\[L:Kar.Matris\\] Let a sequence\n$A_1,\\dotsc,A_r \\in {\\mathrm{M}}_n({\\mathcal}{K})$ of upper triangular\nmatrices be given, and denote by ${\\mathcal}{A}$ the generated by these\nmatrices. For every sequence\n$\\lambda_1,\\dotsc,\\lambda_r \\in {\\mathcal}{K}$ of scalars there exists a\nmatrix $C \\in {\\mathcal}{A}$ such that $$d_i(C) = \\begin{cases}\n      1& \\text{if \\(d_i(A_k)=\\lambda_k\\) for all \\(k \\in [r]\\),}\\\\\n      0& \\text{otherwise}\n    \\end{cases}$$ for all $i \\in [n]$.\n\nThe proof of that lemma can be found in .\n\nThe proof is by induction on the number of equivalence classes of\n$\\sim$. If there is only one equivalence class then one can take $B=I$.\n\nIf there is more than one equivalence class, then let $S$ be the\nequivalence class that contains $n$. By Lemma\u00a0\\[L:Kar.Matris\\] there\nexists a matrix $C$ in the unital algebra generated by $A_1,\\dotsc,A_r$\n(hence necessarily upper triangular) such that $d_i(C) = 1$ for all\n$i \\in S$ and $d_i(C)=0$ for all $i \\in \n  [n] \\setminus S$. Thus $C$ has a\n$$C = \\begin{pmatrix} C_{11}& C_{12} \\\\ 0& C_{22} \\end{pmatrix}$$ where\n$C_{22}$ is a $\\lvert S\\rvert \\times \\lvert S\\rvert$ matrix that has all\n$1$s on the diagonal, and $C_{11}$ is a\n$\\bigl( n -\\nobreak \\lvert S\\rvert \\bigr) \\times\n  \\bigl( n -\\nobreak \\lvert S\\rvert \\bigr)$ matrix that has all $0$s on\nthe diagonal.\n\nLet $k \\in [r]$ be arbitrary and similarly decompose $$\\begin{aligned}\n    C^n ={}& \\begin{pmatrix} D_{11}& D_{12} \\\\ 0& D_{22} \\end{pmatrix} \n    \\text{,}&\n    A_k ={}& \\begin{pmatrix} A_{11}& A_{12} \\\\ 0& A_{22} \\end{pmatrix} \n    \\text{.}\n  \\end{aligned}$$ One can identify $D_{11} = (C_{11})^n$ and\n$D_{22} = (C_{22})^n$, but due to the zero diagonal of $C_{11}$ and the\nfact that the of these matrices are smaller than $n$, the more striking\nequality $D_{11}=0$ also holds. As for $D_{22}$, one may conclude that\nit is invertible.\n\nSince the algebra that $C^n$ belongs to was generated by pairwise\ncommuting elements, it is a algebra, and in particular\n$C^n A_k = A_k C^n$. In of the individual blocks, this becomes\n$$\\begin{pmatrix}\n      0& D_{12}A_{22} \\\\\n      0& D_{22}A_{22}\n    \\end{pmatrix} = \\begin{pmatrix}\n      0& A_{11}D_{12} + A_{12}D_{22} \\\\\n      0& A_{22}D_{22}\n    \\end{pmatrix}\n    \\text{.}$$ Now let\n$$D = \\begin{pmatrix} I& D_{12} \\\\ 0& D_{22} \\end{pmatrix}\n    \\text{, so that }\n    D^{-1} = \\begin{pmatrix} \n      I& -D_{12}D_{22}^{-1} \\\\ \n      0& D_{22}^{-1}\n    \\end{pmatrix}$$ and consider the matrix $D^{-1}A_kD$. Clearly\n$$\\begin{gathered}\n    D^{-1}A_kD =\n    D^{-1} \\begin{pmatrix} A_{11}& A_{12} \\\\ 0& A_{22} \\end{pmatrix}\n      \\begin{pmatrix} I& D_{12} \\\\ 0& D_{22} \\end{pmatrix} = \\\\ =\n    D^{-1} \\begin{pmatrix}\n      A_{11}& A_{11}D_{12} + A_{12}D_{22} \\\\\n      0& A_{22} D_{22}\n    \\end{pmatrix} = \n    \\begin{pmatrix} \n      I& -D_{12}D_{22}^{-1} \\\\ 0& D_{22}^{-1} \n    \\end{pmatrix}\n    \\begin{pmatrix} \n      A_{11}& D_{12}A_{22} \\\\ 0& D_{22} A_{22}\n    \\end{pmatrix} = \\\\ =\n    \\begin{pmatrix} \n      A_{11}& D_{12}A_{22} -D_{12}D_{22}^{-1}D_{22}A_{22} \\\\\n      0& D_{22}^{-1} D_{22} A_{22}\n    \\end{pmatrix} =\n    \\begin{pmatrix} \n      A_{11}& 0 \\\\\n      0& A_{22}\n    \\end{pmatrix}\n  \\end{gathered}$$ so that the positions with row not in $S$ and column\nin $S$ are all zero, as requested for $B^{-1}A_kB$. It should be\nobserved that the choice of $D$ is independent of $k$, and that the same\n$D$ thus works for all the $A_k$.\n\nIn order to complete the proof, one applies the induction hypothesis to\nthe restriction of $\\sim$ to $[n] \\setminus S$ and the corresponding\nsubmatrices of $D^{-1} A_k D$, which satisfy the same conditions but\nhave one equivalence class less. This produces a block-diagonalising\nmatrix $B'$ for these submatrices, and thus the sought $B$ can be\nconstructed as $D \\left( \\begin{smallmatrix} \n  B'&0 \\\\ 0&I \\end{smallmatrix} \\right)$.",
  "citations": [
    {
      "textCitation": "https://planetmath.org/SimultaneousBlockdiagonalizationOfUpperTriangularCommutingMatrices"
    }
  ],
  "indexable": true,
  "names": [
    "simultaneous block-diagonalization of upper triangular commuting matrices"
  ]
}