{
  "language": "INFORMAL",
  "remarks": "",
  "statement": "Let ${\\mathbf}{e}_i$ denote the (column) vector whose $i$th position is\n$1$ and where all other positions are $0$. Denote by $[n]$ the set\n$\\{1,\\dotsc,n\\}$. Denote by ${\\mathrm{M}}_n({\\mathcal}{K})$ the set of\nall $n \\times \nn$ matrices over ${\\mathcal}{K}$, and by\n${\\mathrm{GL}}_n({\\mathcal}{K})$ the set of all invertible elements of\n${\\mathrm{M}}_n({\\mathcal}{K})$. Let $d_i$ be the function which\nextracts the $i$th diagonal element of a matrix, i.e., $d_i(A) \n= {{\\mathbf}{e}_i^{\\mathrm{T}}\\!} A {\\mathbf}{e}_i$.\n\nLet ${\\mathcal}{K}$ be a field, let\n$A_1,\\dotsc,A_r \\in {\\mathrm{M}}_n({\\mathcal}{K})$ be pairwise commuting\nmatrices, and let ${\\mathcal}{L}$ be a field extension of\n${\\mathcal}{K}$ in which the characteristic polynomials of all $A_k$ .\nThen there exists some $P \\in {\\mathrm{GL}}_n({\\mathcal}{L})$ such that\n\n1.  $P^{-1} A_k P$ is upper triangular for all $k=1,\\dotsc,r$, and\n\n2.  if $i,j,l \\in [n]$ are such that $i \\leqslant l \\leqslant j$ and\n    $d_i(P^{-1} A_k P) = d_j(P^{-1} A_k P)$ for all $k=1,\\dotsc,r$, then\n    $d_l(P^{-1} A_k P) = d_j(P^{-1} A_k P)$ for all $k=1,\\dotsc,r$ as\n    well.\n\nThe proof relies on two lemmas.\n\n\\[L1\\] Let ${\\mathcal}{K}$ be a field, let\n$A_1,\\dotsc,A_r \\in {\\mathrm{M}}_n({\\mathcal}{K})$ be pairwise commuting\nmatrices, and let ${\\mathcal}{L}$ be a field extension of\n${\\mathcal}{K}$ in which the characteristic polynomials of all $A_k$\nsplit. Then there exists some nonzero ${\\mathbf}{u} \\in {\\mathcal}{L}^n$\nwhich is an eigenvector of $A_k$ for all $k=1,\\dotsc,r$.\n\n\\[L2\\] For any sequence\n$R_1,\\dotsc,R_r \\in {\\mathrm{M}}_n({\\mathcal}{L})$ of upper triangular\npairwise commuting matrices and every row index $i \\in [n]$, there\nexists ${\\mathbf}{v} \\in {\\mathcal}{L}^n \\setminus \\{0\\}$ such that\n$$R_k {\\mathbf}{v} = d_i(R_k) {\\mathbf}{v}\n    \\quad\\text{for all \\(k \\in [r]\\).}$$\n\nThis is by induction on $n$. The induction hypothesis is that given\npairwise commuting matrices\n$A_1,\\dotsc,A_r \\in {\\mathrm{M}}_n({\\mathcal}{L})$, whose characteristic\npolynomials all split in ${\\mathcal}{L}$, and a sequence of arbitrary\nscalars $\\mu_1,\\dotsc,\\mu_r \\in {\\mathcal}{L}$, there exists some\n$P \\in {\\mathrm{GL}}_n({\\mathcal}{L})$ such that:\n\n1.  \\[Cond:Triangular\\] $P^{-1} A_k P$ is upper triangular for all\n    $k=1,\\dotsc,r$.\n\n2.  \\[Cond:Block\\] If some $i,j \\in [n]$ are such that $i<j$ and\n    $d_j(P^{-1} A_k P) = d_i(P^{-1} A_k P)$ for all $k \\in [r]$, then\n    $d_{i+1}(P^{-1} A_k P) = d_i(P^{-1} A_k P)$.\n\n3.  \\[Cond:Forst\\] If some $j \\in [n]$ is such that\n    $d_j(P^{-1} A_k P) = \\mu_k$ for all $k \\in [r]$, then\n    $d_1(P^{-1} A_k P) = \\mu_k$ for all $k \\in [r]$.\n\nFor $n=1$ this hypothesis is trivially fulfilled (all $1 \\times 1$\nmatrices are upper triangular). Assume that it holds for $n=m$ and\nconsider the case $n=m+1$.\n\nIt is easy to see that condition\u00a0\\[Cond:Triangular\\] implies that\n$P{\\mathbf}{e}_1$ must be an eigenvector that is common to all the\nmatrices. If there exists a nonzero vector\n${\\mathbf}{u}_1 \\in {\\mathcal}{L}^n$ such that\n$A_k {\\mathbf}{u}_1 = \\mu_k {\\mathbf}{u}_1$ for all $k=1,\\dotsc,r$ then\nthis is such a common eigenvector, and in that case let\n$\\lambda_k=\\mu_k$ for all $k=1,\\dotsc,r$. Otherwise there by\nLemma\u00a0\\[L1\\] exists a vector\n${\\mathbf}{u}_1 \\in {\\mathcal}{L}^n \\setminus \\{{\\mathbf}{0}\\}$ such\nthat $A_k {\\mathbf}{u}_1 = \\lambda_k {\\mathbf}{u}_1$ for some\n$\\{\\lambda_k\\}_{k=1}^r \\subseteq {\\mathcal}{L}$. Either way, one gets a\nsuitable candidate ${\\mathbf}{u}_1$ for $P{\\mathbf}{e}_1$ and\neigenvalues $\\lambda_1,\\dotsc,\\lambda_r$ that incidentally will satisfy\n$d_1(P^{-1} A_k P) = \\lambda_k$ for all $k \\in [r]$.\n\nLet ${\\mathbf}{u}_2,\\dotsc,{\\mathbf}{u}_n \\in {\\mathcal}{L}^n$ be\narbitrary vectors such that $\\{{\\mathbf}{u}_i\\}_{i=1}^n$ is a basis of\n${\\mathcal}{L}^n$. Let $U$ be the $n \\times n$ matrix whose $i$th column\nis ${\\mathbf}{u}_i$ for $1 \\leqslant i \\leqslant n$.[^1] Then $U$ is\ninvertible and for each $k$ the first column of $B_k = U^{-1} A_k U$ is\n$$U^{-1} A_k U {\\mathbf}{e}_1 =\n    U^{-1} A_k {\\mathbf}{u}_1 =\n    \\lambda_k U^{-1} {\\mathbf}{u}_1 =\n    \\lambda_k {\\mathbf}{e}_1\n    \\text{.}$$ Furthermore $$\\begin{gathered}\n    B_j B_k = U^{-1} A_j U U^{-1} A_k U =\n    U^{-1} A_j A_k U = \\\\ = \n    U^{-1} A_k A_j U = \n    U^{-1} A_k U U^{-1} A_j U = B_k B_j\n  \\end{gathered}$$ for all $j$ and $k$.\n\nNow let $A_k'$ be the matrix formed from rows and columns $2$ though $n$\nof $B_k$. Since $\\det(A_k -\\nobreak xI) = \n  \\det( B_k -\\nobreak xI ) = (\\lambda_k -\\nobreak x) \n  \\det( A_k' -\\nobreak xI )$ by along the first column, it follows that\nthe characteristic polynomial of $A_k'$ splits in ${\\mathcal}{L}$.\nFurthermore all the $A_k'$ have side $m = n-1$ and commute pairwise with\neach other, whence by the induction hypothesis there exists some\n$P' \\in {\\mathrm{GL}}_{n-1}({\\mathcal}{L})$ such that every\n$P'^{-1} A_k' P'$ is upper triangular. Let $P = \n  U \\left(\\begin{smallmatrix} 1& 0 \\\\ 0& P' \\end{smallmatrix}\\right) \n  $. Then the submatrix consisting of rows and columns $2$ through $n$\nof $P^{-1} A_k P$ is equal to $P'^{-1} A_k' P'$ and hence contains no\nnonzero subdiagonal elements. Furthermore the first column of\n$P^{-1} A_k P$ is equal to the first column of $B_k$ and thus the\n$P^{-1} A_k P$ are all upper triangular, as claimed.\n\nIt also follows from the induction hypothesis that $P$ can be chosen\nsuch that $d_2(P^{-1} A_k P) = d_1(P'^{-1} A_k' P') = \\lambda_k = \n  d_1(P^{-1} A_k P)$ for all $k \\in [r]$ if there is any $j \n  \\geqslant 2$ for which $d_j(P^{-1} A_k P) = d_{j-1}(P'^{-1} A_k' \n  P') = \\lambda_k = d_1(P^{-1} A_k P)$ for all $k \\in [r]$ and more\ngenerally if $2 \\leqslant i < j$ are such that\n$d_j(P^{-1} A_k P) = d_i(P^{-1} A_k P)$ for all $k \\in [r]$ then\nsimilarly $d_{i+1}(P^{-1} A_k P) = d_i(P^{-1} A_k P)$ for all\n$k \\in [r]$. This has verified condition\u00a0\\[Cond:Block\\] of the induction\nhypothesis. For the remaining condition\u00a0\\[Cond:Forst\\], one may first\nobserve that if there is some $i \\in [n]$ such that\n$d_i(P^{-1} A_k P) = \n  \\mu_k$ for all $k \\in [r]$ then by Lemma\u00a0\\[L2\\] there exists a nonzero\n${\\mathbf}{v} \\in {\\mathcal}{L}^n$ such that\n$P^{-1} A_k P {\\mathbf}{v} = \\mu_k {\\mathbf}{v}$ for all $k \\in [r]$.\nThis means $P {\\mathbf}{v}$ will fulfill the condition for choice of\n${\\mathbf}{u}_1$, and hence $d_1(P^{-1} A_k P) = \\lambda_k = \\mu_k$ as\nclaimed.\n\nThe theorem now follows from the principle of induction.\n\n[^1]: By imposing extra conditions on the choice of the basis\n    $\\{{\\mathbf}{u}_i\\}_{i=1}^n$ (such as for example requesting that it\n    is orthonormal) at this point, one can often prove a stronger claim\n    where the choice of $P$ is restricted to some smaller group of\n    matrices (for example the group of orthogonal matrices), but this\n    requires assuming additional things about the fields ${\\mathcal}{K}$\n    and ${\\mathcal}{L}$.",
  "citations": [
    {
      "textCitation": "https://planetmath.org/SimultaneousTriangularisationOfCommutingMatricesOverAnyField"
    }
  ],
  "indexable": true,
  "names": [
    "simultaneous triangularisation of commuting matrices over any field"
  ]
}