{
  "language": "INFORMAL",
  "remarks": "",
  "statement": "Let $(a_n)$ be a linear recursive sequence with values in a\n(commutative) ring $R$, i.e. there exist constants\n$\\beta_1,\\ldots,\\beta_k\\in R$ such that for any $n>k$ we have\n$$a_n=\\beta_1\\cdot a_{n-1} + \\cdots + \\beta_i\\cdot a_{n-i} + \\cdots + \\beta_{k}\\cdot a_{n-k}.$$\nNow consider the ordinary generating function for this sequence\n$$f(t)=\\sum_{n\\geqslant 0}a_n\\cdot t^n$$ which is a formal power series\nin the ring of formal power series $R[[t]]$. We will try to find the\nclosed form of $f(t)$.\n\nFirst write down first $k$ elements of this power series:\n$$f(t)=\\sum_{n=0}^{k}a_n\\cdot t^n + \\sum_{n>k}a_n\\cdot t^n$$ and note\nthat for $n>k$ we can use our recursive relation:\n$$f(t)=\\sum_{n=0}^{k}a_n\\cdot t^n + \\sum_{n>k}(\\beta_1\\cdot a_{n-1}+\\cdots +\\beta_k\\cdot a_{n-k})\\cdot t^n$$\nwhich gives us $$\\begin{aligned}\nf(t)=\\sum_{n=0}^{k}a_n\\cdot t^n + \\left(\\beta_1\\cdot t\\cdot \\sum_{n>k}a_{n-1}\\cdot t^{n-1}\\right) +\\cdots +\\left(\\beta_k\\cdot t^k\\cdot \\sum_{n>k}a_{n-k}\\cdot t^{n-k}\\right).\\end{aligned}$$\nNow focus on those sums on the right. For any $j$ we have\n$$\\sum_{n>k}a_{n-j}\\cdot t^{n-j} = \\left(\\sum_{n\\geqslant 0}a_n\\cdot t^n \\right) - \\left(\\sum_{n=0}^{k-j}a_n\\cdot t^n\\right) = f(t) - \\left(\\sum_{n=0}^{k-j}a_n\\cdot t^n\\right).$$\nInserting this into (1) gives us\n$$f(t) = \\sum_{n=0}^{k}a_n\\cdot t^n + \\left(\\beta_1\\cdot t\\cdot(f(t)-\\sum_{n=0}^{k-1}a_n\\cdot t^n)\\right) + \\cdots + \\left(\\beta_k\\cdot t^k\\cdot(f(t)-\\sum_{n=0}^{0}a_n\\cdot t^n)\\right)$$\nwhich can be simplified as follows:\n$$f(t) = \\sum_{n=0}^{k}a_n\\cdot t^n  + \\sum_{j=1}^{k}\\left(\\beta_j\\cdot t^j\\cdot(f(t)-\\sum_{n=0}^{k-j}a_n\\cdot t^n)\\right).$$\nTaking the components with $f(t)$ to the left side gives us\n$$f(t)-\\sum_{j=1}^{k}\\beta_j\\cdot t^j\\cdot f(t) = \\sum_{n=0}^{k}a_n\\cdot t^n  - \\sum_{j=1}^{k}\\left(\\beta_j\\cdot t^j\\cdot\\sum_{n=0}^{k-j}a_n\\cdot t^n\\right),$$\nwhich finally gives us the closed formula for $f(t)$ (note that all sums\nare finite):\n$$f(t)=\\frac{\\sum\\limits_{n=0}^{k}a_n\\cdot t^n - \\sum\\limits_{j=1}^{k}\\left(\\beta_j\\cdot t^j\\cdot\\sum\\limits_{n=0}^{k-j}a_n\\cdot t^n\\right)}{1-\\sum\\limits_{j=1}^{k}\\beta_j\\cdot t^j}.$$\nNote that in the denominator we have a power series with the constant\nterm $1$, thus (by general properties of formal power series) it is\ninvertible in $R[[t]]$. Thus we proved the following theorem:\n\n**Theorem.** If $(a_n)$ is a recursive sequnce given by\n$$a_n=\\beta_1\\cdot a_{n-1}+\\cdots+\\beta_k\\cdot a_{n-k}$$ for all $n>k$\nthen the ordinary generating function\n$$f(t)=\\sum_{n\\geqslant 0}a_n\\cdot t^n$$ has its closed form given by\n$$f(t)=\\frac{\\sum\\limits_{n=0}^{k}a_n\\cdot t^n  - \\sum\\limits_{j=1}^{k}\\left(\\beta_j\\cdot t^j\\cdot\\sum\\limits_{n=0}^{k-j}a_n\\cdot t^n\\right)}{1-\\sum\\limits_{j=1}^{k}\\beta_j\\cdot t^j}.$$\n\n**Remark.** Note that if we replace $R$ with (for example) the reals\n$\\mathbb{R}$ then the theorem is still valid if we treat those power\nseries as functions. Of course such equalites hold only there where\nthose functions are defined.",
  "citations": [
    {
      "textCitation": "https://planetmath.org/OrdinaryGeneratingFunctionForLinearRecursiveRelations"
    }
  ],
  "indexable": true,
  "names": [
    "ordinary generating function for linear recursive relations"
  ]
}